<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <title>Become a Garcia Builder Trainer | Join the Coaching Team</title>
    <meta name="description" content="Apply to coach with Garcia Builder. Work with a global client roster, premium systems, and a results-driven methodology that helps you grow your online coaching career."/>
    <meta name="theme-color" content="#05060f"/>
    <link rel="canonical" href="https://www.garciabuilder.fitness/pages/public/become-trainer.html"/>

    <link rel="preconnect" href="https://fonts.googleapis.com"/>
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha512-NdY32d+J1U/9PfAFMdjoMxONJrG8TrHtTu1JJSsrB/pT4Pvyt6xM1w1ibD5U1Urnnu5u+9mQjkFxrM5dFQhsgw==" crossorigin="anonymous" referrerpolicy="no-referrer"/>
    <link rel="stylesheet" href="../../css/global.css?v=20251028"/>
    <link rel="stylesheet" href="../../css/components/navbar-component.css?v=20251028"/>
    <link rel="stylesheet" href="../../css/components/enhanced-navbar.css?v=20251008"/>
    <link rel="stylesheet" href="../../css/pages/become-trainer.css?v=20251104"/>

    <link rel="preload" as="script" href="../../js/utils/component-loader-v3-simplified.js?v=20251029" crossorigin="anonymous"/>
    <link rel="preload" as="fetch" href="../../components/navbar.html" crossorigin="anonymous"/>
    <link rel="preload" as="fetch" href="../../components/footer.html" crossorigin="anonymous"/>

    <script defer src="../../assets/i18n.js?v=20251025"></script>
    <script defer src="../../js/utils/component-loader-v3-simplified.js?v=20251029"></script>
</head>

<body class="trainer-page">
<div data-component="navbar" data-active="become-trainer"></div>

<main class="trainer-main">
    <section class="trainer-hero section-padding">
        <div class="container">
            <div class="row align-items-center gy-5">
                <div class="col-lg-6">
                    <span class="hero-eyebrow"><i class="fas fa-bolt" aria-hidden="true"></i> Coach with Garcia Builder</span>
                    <h1 class="hero-title">Become a Garcia Builder Trainer</h1>
                    <p class="hero-description">
                        Join a global roster of expert coaches who combine evidence-based programming, compassionate accountability
                        and cinematic delivery to transform lives in 12 weeks or less.
                    </p>
                    <div class="trainer-badges">
                        <span class="trainer-badge"><i class="fas fa-diagram-project" aria-hidden="true"></i> Proven systems</span>
                        <span class="trainer-badge"><i class="fas fa-users-line" aria-hidden="true"></i> Curated client leads</span>
                        <span class="trainer-badge"><i class="fas fa-mobile-screen" aria-hidden="true"></i> All-in-one platform</span>
                    </div>
                    <div class="d-flex flex-column flex-sm-row gap-3 mt-4">
                        <a class="btn btn-warning btn-lg px-4 fw-semibold" href="#application">
                            <i class="fas fa-paper-plane me-2" aria-hidden="true"></i>Apply now
                        </a>
                        <a class="btn btn-outline-light btn-lg px-4 fw-semibold" href="https://calendly.com/andrenjulio072/consultation" target="_blank" rel="noopener">
                            <i class="fas fa-calendar-check me-2" aria-hidden="true"></i>Book an intro call
                        </a>
                    </div>
                </div>
                <div class="col-lg-6">
                    <div class="trainer-hero-card">
                        <img src="../../assets/images/avatars/avatar-f1.svg" alt="Garcia Builder coach illustration" class="trainer-hero-illustration" loading="lazy" decoding="async"/>
                        <ul class="trainer-hero-stats">
                            <li>
                                <span class="stat-head">180+</span>
                                <span class="stat-copy">Active online coaching clients managed in one platform.</span>
                            </li>
                            <li>
                                <span class="stat-head">40%</span>
                                <span class="stat-copy">Average client retention increase after 90 days with our check-in rhythm.</span>
                            </li>
                            <li>
                                <span class="stat-head">12 hrs</span>
                                <span class="stat-copy">Weekly admin time saved through automated reporting &amp; onboarding flows.</span>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <section class="trainer-metrics section-padding">
        <div class="container">
            <div class="row g-4 row-cols-1 row-cols-md-3">
                <div class="col">
                    <div class="trainer-metric-card h-100">
                        <i class="fas fa-fire" aria-hidden="true"></i>
                        <h3 class="h4 fw-semibold text-white">Lead engine included</h3>
                        <p class="mb-0 text-muted">Receive qualified prospects from our campaigns plus templates to nurture your own audience.</p>
                    </div>
                </div>
                <div class="col">
                    <div class="trainer-metric-card h-100">
                        <i class="fas fa-handshake-angle" aria-hidden="true"></i>
                        <h3 class="h4 fw-semibold text-white">Coaching playbooks</h3>
                        <p class="mb-0 text-muted">Plug into proven check-in scripts, training blocks and behaviour frameworks that keep clients engaged.</p>
                    </div>
                </div>
                <div class="col">
                    <div class="trainer-metric-card h-100">
                        <i class="fas fa-globe-europe" aria-hidden="true"></i>
                        <h3 class="h4 fw-semibold text-white">Global reach</h3>
                        <p class="mb-0 text-muted">Coach multilingual clients across Europe, the UK and Brazil with built-in localisation and translation support.</p>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <section class="trainer-benefits section-padding" id="benefits">
        <div class="container">
            <div class="row g-4 align-items-center mb-4">
                <div class="col-lg-7">
                    <h2 class="trainer-section-title">Operate like a modern coaching studio</h2>
                    <p class="trainer-section-subtitle">
                        Your expertise paired with our infrastructure means clients experience world-class service from the first
                        message to their final transformation photo.
                    </p>
                </div>
            </div>
            <div class="row g-4 row-cols-1 row-cols-md-2 row-cols-xl-3">
                <div class="col">
                    <div class="trainer-benefit-card h-100">
                        <i class="fas fa-people-roof" aria-hidden="true"></i>
                        <h3 class="h5 text-white fw-semibold">Client relationship OS</h3>
                        <p class="text-muted mb-0">Centralised client dashboards with macros, photos, check-ins and schedulingno more spreadsheets.</p>
                    </div>
                </div>
                <div class="col">
                    <div class="trainer-benefit-card h-100">
                        <i class="fas fa-wifi" aria-hidden="true"></i>
                        <h3 class="h5 text-white fw-semibold">Live accountability</h3>
                        <p class="text-muted mb-0">In-app messaging, automated nudges and templated playbooks keep every client seen and supported.</p>
                    </div>
                </div>
                <div class="col">
                    <div class="trainer-benefit-card h-100">
                        <i class="fas fa-brain" aria-hidden="true"></i>
                        <h3 class="h5 text-white fw-semibold">Strategic mentorship</h3>
                        <p class="text-muted mb-0">Monthly coaching labs, business reviews and marketing support to scale sustainably.</p>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <section class="trainer-tools section-padding">
        <div class="container">
            <div class="row g-4 align-items-center mb-4">
                <div class="col-lg-6">
                    <h2 class="trainer-section-title">Tools youll plug into day one</h2>
                    <p class="trainer-section-subtitle">Every Garcia Builder trainer gains access to the same stack that powers our flagship transformation program.</p>
                </div>
            </div>
            <div class="row g-4 row-cols-1 row-cols-md-2">
                <div class="col">
                    <div class="trainer-tool-card h-100">
                        <i class="fas fa-laptop-code" aria-hidden="true"></i>
                        <h3 class="h5 text-white fw-semibold">Program design suite</h3>
                        <ul class="mb-0 text-muted ps-3">
                            <li>Video exercise library and templated periodisation blocks.</li>
                            <li>Automated macro calculators with cultural meal examples.</li>
                        </ul>
                    </div>
                </div>
                <div class="col">
                    <div class="trainer-tool-card h-100">
                        <i class="fas fa-chart-pie" aria-hidden="true"></i>
                        <h3 class="h5 text-white fw-semibold">Business cockpit</h3>
                        <ul class="mb-0 text-muted ps-3">
                            <li>Revenue tracking, renewal prompts and churn predictions.</li>
                            <li>Marketing asset vault, sales scripts and launch calendars.</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <section class="trainer-process section-padding" id="process">
        <div class="container">
            <div class="row mb-4">
                <div class="col-lg-8">
                    <h2 class="trainer-section-title">Four steps to start coaching</h2>
                    <p class="trainer-section-subtitle">We review every application within 48 hours and provide feedback whether youre approved or not.</p>
                </div>
            </div>
            <div class="row g-4 row-cols-1 row-cols-lg-4">
                <div class="col">
                    <div class="trainer-process-step h-100 text-lg-start text-center">
                        <div class="step-number mx-lg-0 mx-auto">1</div>
                        <h3 class="h5 text-white fw-semibold">Complete application</h3>
                        <p class="text-muted mb-0">Share your experience, coaching style and ideal client avatar.</p>
                    </div>
                </div>
                <div class="col">
                    <div class="trainer-process-step h-100 text-lg-start text-center">
                        <div class="step-number mx-lg-0 mx-auto">2</div>
                        <h3 class="h5 text-white fw-semibold">Upload credentials</h3>
                        <p class="text-muted mb-0">Attach certifications or proof of practical experience.</p>
                    </div>
                </div>
                <div class="col">
                    <div class="trainer-process-step h-100 text-lg-start text-center">
                        <div class="step-number mx-lg-0 mx-auto">3</div>
                        <h3 class="h5 text-white fw-semibold">Panel review</h3>
                        <p class="text-muted mb-0">Our senior coaches evaluate fit, quality and availability.</p>
                    </div>
                </div>
                <div class="col">
                    <div class="trainer-process-step h-100 text-lg-start text-center">
                        <div class="step-number mx-lg-0 mx-auto">4</div>
                        <h3 class="h5 text-white fw-semibold">Onboard &amp; coach</h3>
                        <p class="text-muted mb-0">Get access to the platform, mentorship and your first clients.</p>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <section class="trainer-requirements section-padding">
        <div class="container">
            <div class="row g-4">
                <div class="col-lg-6">
                    <div class="requirement-card h-100">
                        <h4 class="h5 text-white fw-semibold">What we look for</h4>
                        <ul>
                            <li><i class="fas fa-check" aria-hidden="true"></i>2+ years coaching experience (online or in-person).</li>
                            <li><i class="fas fa-check" aria-hidden="true"></i>Evidence-based approach with clear transformation outcomes.</li>
                            <li><i class="fas fa-check" aria-hidden="true"></i>Strong communication skills and client empathy.</li>
                            <li><i class="fas fa-check" aria-hidden="true"></i>Availability for weekly check-ins and monthly team reviews.</li>
                        </ul>
                    </div>
                </div>
                <div class="col-lg-6">
                    <div class="requirement-card h-100">
                        <h4 class="h5 text-white fw-semibold">Nice to have</h4>
                        <ul>
                            <li><i class="fas fa-star" aria-hidden="true"></i>Certifications (NASM, ACE, ISSA, ACSM or equivalent).</li>
                            <li><i class="fas fa-star" aria-hidden="true"></i>Nutrition certifications or experience with meal planning.</li>
                            <li><i class="fas fa-star" aria-hidden="true"></i>Ability to coach in English plus Portuguese or Spanish.</li>
                            <li><i class="fas fa-star" aria-hidden="true"></i>Comfortable on camera for weekly Loom/video check-ins.</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <section class="section-padding" id="application">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-lg-10 col-xl-9">
                    <div class="trainer-form-card">
                        <div class="d-flex flex-column flex-lg-row justify-content-between gap-3 mb-4">
                            <div>
                                <span class="section-label d-inline-block mb-2">Submit your profile</span>
                                <h3 class="h2 text-white mb-2">Trainer application</h3>
                                <p class="text-muted mb-0">Tell us about your coaching craft. Fields marked with * are required.</p>
                            </div>
                            <div class="text-lg-end">
                                <p class="text-muted small mb-2"><i class="far fa-clock me-1" aria-hidden="true"></i>Review within 2448 h</p>
                                <p class="text-muted small mb-0"><i class="far fa-file-lines me-1" aria-hidden="true"></i>Uploads optional but recommended</p>
                            </div>
                        </div>

                        <div id="application-status" class="mb-4"></div>

                        <form id="trainer-application-form" novalidate>
                            <div class="mb-4">
                                <h4 class="h5 text-white fw-semibold mb-3">Basic information</h4>
                                <div class="row g-3">
                                    <div class="col-md-6">
                                        <label for="full_name" class="form-label">Full name *</label>
                                        <input type="text" class="form-control" id="full_name" autocomplete="name" required/>
                                    </div>
                                    <div class="col-md-6">
                                        <label for="email" class="form-label">Email *</label>
                                        <input type="email" class="form-control" id="email" autocomplete="email" required/>
                                    </div>
                                    <div class="col-md-6">
                                        <label for="phone" class="form-label">Phone *</label>
                                        <input type="tel" class="form-control" id="phone" autocomplete="tel" required/>
                                    </div>
                                    <div class="col-md-6">
                                        <label for="experience_years" class="form-label">Years of experience *</label>
                                        <select class="form-select" id="experience_years" required>
                                            <option value="">Select experience</option>
                                            <option value="0-1">0-1 years</option>
                                            <option value="2-5">2-5 years</option>
                                            <option value="6-10">6-10 years</option>
                                            <option value="10+">10+ years</option>
                                        </select>
                                    </div>
                                </div>
                            </div>

                            <div class="mb-4">
                                <h4 class="h5 text-white fw-semibold mb-3">Specialisations</h4>
                                <p class="text-muted small mb-3">Select all the domains you actively coach.</p>
                                <div class="row g-3">
                                    <div class="col-md-4">
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" id="weight_loss" value="weight_loss" data-specialty-checkbox>
                                            <label class="form-check-label" for="weight_loss">Weight loss &amp; recomposition</label>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" id="muscle_building" value="muscle_building" data-specialty-checkbox>
                                            <label class="form-check-label" for="muscle_building">Muscle building</label>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" id="strength_training" value="strength_training" data-specialty-checkbox>
                                            <label class="form-check-label" for="strength_training">Strength training</label>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" id="cardio_fitness" value="cardio_fitness" data-specialty-checkbox>
                                            <label class="form-check-label" for="cardio_fitness">Cardio &amp; conditioning</label>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" id="yoga_pilates" value="yoga_pilates" data-specialty-checkbox>
                                            <label class="form-check-label" for="yoga_pilates">Mobility / yoga / pilates</label>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" id="sports_specific" value="sports_specific" data-specialty-checkbox>
                                            <label class="form-check-label" for="sports_specific">Sport-specific prep</label>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" id="nutrition" value="nutrition" data-specialty-checkbox>
                                            <label class="form-check-label" for="nutrition">Nutrition coaching</label>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" id="rehabilitation" value="rehabilitation" data-specialty-checkbox>
                                            <label class="form-check-label" for="rehabilitation">Rehab / corrective work</label>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" id="senior_fitness" value="senior_fitness" data-specialty-checkbox>
                                            <label class="form-check-label" for="senior_fitness">Senior fitness</label>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="mb-4">
                                <h4 class="h5 text-white fw-semibold mb-3">Certifications &amp; philosophy</h4>
                                <div class="row g-3">
                                    <div class="col-12">
                                        <label for="certifications" class="form-label">List your certifications *</label>
                                        <textarea class="form-control" id="certifications" rows="3" placeholder="e.g., NASM-CPT, ACE Personal Trainer, Precision Nutrition L1" required></textarea>
                                    </div>
                                    <div class="col-12">
                                        <label for="bio" class="form-label">Tell us about your approach *</label>
                                        <textarea class="form-control" id="bio" rows="4" placeholder="Share your story, signature methods and what clients can expect when working with you." required></textarea>
                                    </div>
                                </div>
                            </div>

                            <div class="mb-4">
                                <h4 class="h5 text-white fw-semibold mb-3">Upload certifications</h4>
                                <div class="certification-upload mb-3" tabindex="0" role="button" aria-label="Upload certification documents" onclick="document.getElementById('certification-files').click()" onkeypress="if(event.key==='Enter'){document.getElementById('certification-files').click();}">
                                    <i class="fas fa-cloud-upload-alt fa-3x text-warning mb-3" aria-hidden="true"></i>
                                    <h6 class="text-white fw-semibold">Upload certification documents</h6>
                                    <p class="text-muted mb-0">Click to select or drag &amp; drop  PDF, JPG, PNG  Max 10MB each</p>
                                    <input type="file" id="certification-files" multiple accept=".pdf,.jpg,.jpeg,.png" hidden/>
                                </div>
                                <div id="uploaded-files" class="mb-4"></div>
                            </div>

                            <div class="form-check mb-4">
                                <input class="form-check-input" type="checkbox" id="terms_agreement" required>
                                <label class="form-check-label" for="terms_agreement">
                                    I agree to the <a href="../../terms.html" class="text-warning">Terms of Service</a> and <a href="../../privacy.html" class="text-warning">Trainer Agreement</a> *
                                </label>
                            </div>

                            <div class="d-flex justify-content-center">
                                <button type="submit" class="btn btn-warning btn-lg px-5 fw-semibold">
                                    <i class="fas fa-paper-plane me-2" aria-hidden="true"></i>Submit application
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <section class="section-padding">
        <div class="container">
            <div class="trainer-cta">
                <h2>Lets transform clients together</h2>
                <p>Submit your application and our coaching panel will reach out within two business days. The next Garcia Builder cohort launches soonsecure your spot on the roster.</p>
                <div class="d-flex flex-column flex-sm-row justify-content-center gap-3 mt-4">
                    <a class="btn btn-warning btn-lg px-4 fw-semibold" href="#application">
                        <i class="fas fa-user-plus me-2" aria-hidden="true"></i>Start application
                    </a>
                    <a class="btn btn-outline-light btn-lg px-4 fw-semibold" href="mailto:coach@garciabuilder.fitness">
                        <i class="fas fa-envelope-open-text me-2" aria-hidden="true"></i>Email the team
                    </a>
                </div>
            </div>
        </div>
    </section>
</main>

<div data-component="footer"></div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" defer></script>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.39.3/dist/umd/supabase.js"></script>
<script defer src="../../js/core/supabase.js"></script>
<script defer src="../../js/core/auth.js"></script>
<script defer src="../../js/core/auth-guard.js?v=20251009"></script>
<script defer src="../../js/components/navigation-manager.js"></script>

<script>
    let currentUser = null;
    let uploadedFiles = [];

    document.addEventListener('DOMContentLoaded', initialiseTrainerApplication);

    async function initialiseTrainerApplication() {
        try {
            if (typeof window.waitForSupabaseClient === 'function') {
                try {
                    await window.waitForSupabaseClient(12000);
                } catch {
                    console.warn('Supabase client did not initialise within the expected time.');
                }
            }

            currentUser = await getCurrentUser();

            if (currentUser?.id) {
                prefillUserInfo();
                await checkExistingApplication();
            } else {
                showLoginPrompt();
            }

            setupFormHandlers();
        } catch (error) {
            console.error('Trainer application init error:', error);
            showNotification('We could not load the trainer application form. Please refresh and try again.', 'error');
        }
    }

    function showLoginPrompt() {
        const applicationForm = document.querySelector('#trainer-application-form');
        if (!applicationForm) return;

        const loginPrompt = document.createElement('div');
        loginPrompt.className = 'alert alert-info border-0 rounded-4 p-4 mb-4';
        loginPrompt.innerHTML = `
            <h5 class="fw-semibold mb-2"><i class="fas fa-info-circle me-2" aria-hidden="true"></i>Login required</h5>
            <p class="mb-3 text-muted">Create a free account or login to submit your trainer application and track the status.</p>
            <div class="d-flex flex-column flex-sm-row gap-2">
                <a class="btn btn-warning fw-semibold" href="../../pages/public/login.html?action=register&redirect=${encodeURIComponent(window.location.pathname)}">
                    <i class="fas fa-user-plus me-2" aria-hidden="true"></i>Create account
                </a>
                <a class="btn btn-outline-light fw-semibold" href="../../pages/public/login.html?action=login&redirect=${encodeURIComponent(window.location.pathname)}">
                    <i class="fas fa-right-to-bracket me-2" aria-hidden="true"></i>Login
                </a>
            </div>
        `;

        applicationForm.parentNode.insertBefore(loginPrompt, applicationForm);

        const inputs = applicationForm.querySelectorAll('input, textarea, select, button');
        inputs.forEach(input => {
            input.disabled = true;
            input.style.opacity = '0.6';
        });
    }

    async function getCurrentUser() {
        try {
            if (window.supabaseClient?.auth) {
                const { data: { user } } = await window.supabaseClient.auth.getUser();
                if (user) return user;
            }

            const stored = localStorage.getItem('gb_current_user');
            return stored ? JSON.parse(stored) : null;
        } catch (error) {
            console.error('Error resolving current user:', error);
            return null;
        }
    }

    function prefillUserInfo() {
        document.getElementById('full_name').value = currentUser.user_metadata?.full_name || '';
        document.getElementById('email').value = currentUser.email || '';
        document.getElementById('phone').value = currentUser.user_metadata?.phone || '';
    }

    async function checkExistingApplication() {
        if (!window.supabaseClient || !currentUser?.id) return;

        try {
            const { data, error } = await window.supabaseClient
                .from('trainer_applications')
                .select('*')
                .eq('user_id', currentUser.id)
                .maybeSingle();

            if (error && error.code !== 'PGRST116') {
                console.warn('Error checking existing application:', error);
                return;
            }

            if (data) {
                const statusDiv = document.getElementById('application-status');
                const status = (data.status || 'pending').toLowerCase();
                let statusClass = 'alert-info';
                let statusText = 'Your application is being reviewed. We will reach out shortly.';

                if (status === 'approved') {
                    statusClass = 'alert-success';
                    statusText = 'Congratulations! Your application is approved. Our team will contact you to start onboarding.';
                } else if (status === 'rejected') {
                    statusClass = 'alert-danger';
                    statusText = 'Your application was not approved this time. You can update your details and resubmit.';
                }

                statusDiv.innerHTML = `
                    <div class="alert ${statusClass} border-0 rounded-4">
                        <h6 class="fw-semibold mb-1 text-uppercase">Application status: ${status.toUpperCase()}</h6>
                        <p class="mb-0">${statusText}</p>
                    </div>
                `;

                if (status !== 'rejected') {
                    document.getElementById('trainer-application-form').style.display = 'none';
                }
            }
        } catch (error) {
            console.warn('No existing trainer application found.', error.message || error);
        }
    }

    function setupFormHandlers() {
        const fileInput = document.getElementById('certification-files');
        fileInput.addEventListener('change', handleFileUpload);
        document.getElementById('trainer-application-form').addEventListener('submit', handleSubmit);
    }

    function handleFileUpload(event) {
        const files = Array.from(event.target.files || []);
        uploadedFiles = [...uploadedFiles, ...files];
        displayUploadedFiles();
    }

    function displayUploadedFiles() {
        const container = document.getElementById('uploaded-files');
        if (!uploadedFiles.length) {
            container.innerHTML = '';
            return;
        }

        const html = uploadedFiles.map((file, index) => `
            <div class="d-flex align-items-center justify-content-between p-2 mb-2">
                <div class="d-flex align-items-center gap-2">
                    <i class="fas fa-file-alt text-warning" aria-hidden="true"></i>
                    <span>${file.name}</span>
                    <small class="text-muted">(${(file.size / 1024 / 1024).toFixed(2)} MB)</small>
                </div>
                <button type="button" class="btn btn-sm btn-outline-danger" data-remove-index="${index}">
                    <i class="fas fa-times" aria-hidden="true"></i>
                </button>
            </div>
        `).join('');

        container.innerHTML = html;
        container.querySelectorAll('button[data-remove-index]').forEach(button => {
            button.addEventListener('click', () => {
                const idx = Number(button.getAttribute('data-remove-index'));
                uploadedFiles.splice(idx, 1);
                displayUploadedFiles();
            });
        });
    }

    async function handleSubmit(event) {
        event.preventDefault();

        if (!currentUser?.id) {
            showNotification('Please login or create an account before submitting your application.', 'error');
            window.location.href = '../../pages/public/login.html?action=register&redirect=' + encodeURIComponent(window.location.pathname);
            return;
        }

        if (!window.supabaseClient) {
            showNotification('Database connection not available. Please refresh the page and try again.', 'error');
            return;
        }

        const submitBtn = event.target.querySelector('button[type="submit"]');
        const originalText = submitBtn.innerHTML;
        submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin me-2" aria-hidden="true"></i>Submitting...';
        submitBtn.disabled = true;

        try {
            const specialties = Array.from(document.querySelectorAll('[data-specialty-checkbox]'))
                .filter(checkbox => checkbox.checked)
                .map(checkbox => checkbox.value);

            const fullName = document.getElementById('full_name').value.trim();
            const email = document.getElementById('email').value.trim();
            const phone = document.getElementById('phone').value.trim();
            const experienceYears = document.getElementById('experience_years').value;
            const certifications = document.getElementById('certifications').value.trim();
            const bio = document.getElementById('bio').value.trim();

            if (!fullName || !email || !phone || !experienceYears || !certifications || !bio) {
                throw new Error('Please complete all required fields before submitting.');
            }

            const applicationData = {
                user_id: currentUser.id,
                full_name: fullName,
                email,
                phone,
                experience_years: experienceYears,
                specialties: JSON.stringify(specialties),
                certifications,
                bio,
                status: 'pending',
                applied_at: new Date().toISOString()
            };

            const { error } = await window.supabaseClient
                .from('trainer_applications')
                .upsert(applicationData, { onConflict: 'user_id', returning: 'minimal' });

            if (error) {
                throw new Error(error.message || 'Failed to submit application.');
            }

            if (uploadedFiles.length) {
                await uploadCertificationPreviews();
            }

            showNotification('Application submitted successfully! We will review it within 2448 hours.', 'success');
            setTimeout(() => window.location.reload(), 2500);
        } catch (error) {
            console.error('Error submitting application:', error);
            showNotification(error.message || 'Failed to submit application. Please try again.', 'error');
        } finally {
            submitBtn.innerHTML = originalText;
            submitBtn.disabled = false;
        }
    }

    async function uploadCertificationPreviews() {
        if (!window.supabaseClient || !uploadedFiles.length || !currentUser?.id) return;

        try {
            const storage = window.supabaseClient.storage.from('trainer_certifications');
            const uploads = uploadedFiles.slice(0, 5).map(async (file, index) => {
                const sanitizedName = file.name.replace(/\s+/g, '-').toLowerCase();
                const path = `${currentUser.id}/${Date.now()}-${index}-${sanitizedName}`;
                const { error } = await storage.upload(path, file, { cacheControl: '3600', upsert: false });
                if (error) throw error;
                return path;
            });

            await Promise.allSettled(uploads);
        } catch (error) {
            console.warn('Certification upload skipped:', error.message || error);
        }
    }

    function showNotification(message, type = 'info') {
        const notification = document.createElement('div');
        const variant = type === 'error' ? 'danger' : type === 'success' ? 'success' : 'info';
        notification.className = `alert alert-${variant} border-0 shadow-lg position-fixed top-0 end-0 m-3`;
        notification.role = 'status';
        notification.style.zIndex = '1080';
        notification.textContent = message;
        document.body.appendChild(notification);
        setTimeout(() => notification.remove(), 4000);
    }
</script>
</body>
</html>
